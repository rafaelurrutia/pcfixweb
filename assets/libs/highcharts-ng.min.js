"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="highcharts-ng"),function(){"use strict";function t(){return{indexOf:function(t,n,i){void 0===i&&(i=0),0>i&&(i+=t.length),0>i&&(i=0);for(var e=t.length;e>i;i++)if(i in t&&t[i]===n)return i;return-1},prependMethod:function(t,n,i){var e=t[n];t[n]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(this,t),e?e.apply(this,t):void 0}},deepExtend:function t(n,i){if(angular.isArray(i)){n=angular.isArray(n)?n:[];for(var e=0;e<i.length;e++)n[e]=t(n[e]||{},i[e])}else if(angular.isObject(i))for(var r in i)n[r]=t(n[r]||{},i[r]);else n=i;return n}}}function n(t,n){var i=0,e=function(t){var n=!1;return angular.forEach(t,function(t){angular.isDefined(t.id)||(t.id="series-"+i++,n=!0)}),n},r=["xAxis","yAxis"],a={stock:"StockChart",map:"Map",chart:"Chart"},o=function(n,i,e){var a={},o={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:!1}};return a=e.options?t.deepExtend(o,e.options):o,a.chart.renderTo=i[0],angular.forEach(r,function(i){angular.isDefined(e[i])&&(a[i]=angular.copy(e[i]),(angular.isDefined(e[i].currentMin)||angular.isDefined(e[i].currentMax))&&(t.prependMethod(a.chart.events,"selection",function(t){var e=this;n.$apply(t[i]?function(){n.config[i].currentMin=t[i][0].min,n.config[i].currentMax=t[i][0].max}:function(){n.config[i].currentMin=e[i][0].dataMin,n.config[i].currentMax=e[i][0].dataMax})}),t.prependMethod(a.chart.events,"addSeries",function(){n.config[i].currentMin=this[i][0].min||n.config[i].currentMin,n.config[i].currentMax=this[i][0].max||n.config[i].currentMax})))}),e.title&&(a.title=e.title),e.subtitle&&(a.subtitle=e.subtitle),e.credits&&(a.credits=e.credits),e.size&&(e.size.width&&(a.chart.width=e.size.width),e.size.height&&(a.chart.height=e.size.height)),a},c=function(t,n){var i=t.getExtremes();(n.currentMin!==i.dataMin||n.currentMax!==i.dataMax)&&t.setExtremes(n.currentMin,n.currentMax,!1)},s=function(t,n,i){(n.currentMin||n.currentMax)&&t[i][0].setExtremes(n.currentMin,n.currentMax,!0)},u=function(n){return t.deepExtend({},n,{data:null,visible:null})},f=function(t){return void 0===t.config?"Chart":a[(""+t.config.chartType).toLowerCase()]||(t.config.useHighStocks?"StockChart":"Chart")};return{restrict:"EAC",replace:!0,template:"<div></div>",scope:{config:"=",disableDataWatch:"="},link:function(i,a){var h={},d=function(n){var r,a=[];if(n){var o=e(n);if(o&&!i.disableDataWatch)return!1;if(angular.forEach(n,function(t){a.push(t.id);var n=g.get(t.id);n?angular.equals(h[t.id],u(t))?(void 0!==t.visible&&n.visible!==t.visible&&n.setVisible(t.visible,!1),n.setData(angular.copy(t.data),!1)):n.update(angular.copy(t),!1):g.addSeries(angular.copy(t),!1),h[t.id]=u(t)}),i.config.noData){var c=!1;for(r=0;r<n.length;r++)if(n[r].data&&n[r].data.length>0){c=!0;break}c?g.hideLoading():g.showLoading(i.config.noData)}}for(r=g.series.length-1;r>=0;r--){var s=g.series[r];"highcharts-navigator-series"!==s.options.id&&t.indexOf(a,s.options.id)<0&&s.remove(!1)}return!0},g=!1,l=function(){g&&g.destroy(),h={};var t=i.config||{},n=o(i,a,t),e=t.func||void 0,c=f(i);g=new Highcharts[c](n,e);for(var u=0;u<r.length;u++)t[r[u]]&&s(g,t[r[u]],r[u]);t.loading&&g.showLoading(),t.getHighcharts=function(){return g}};l(),i.disableDataWatch?i.$watchCollection("config.series",function(t){d(t),g.redraw()}):i.$watch("config.series",function(t){var n=d(t);n&&g.redraw()},!0),i.$watch("config.title",function(t){g.setTitle(t,!0)},!0),i.$watch("config.subtitle",function(t){g.setTitle(!0,t)},!0),i.$watch("config.loading",function(t){t?g.showLoading(t===!0?null:t):g.hideLoading()}),i.$watch("config.noData",function(t){i.config&&i.config.loading&&g.showLoading(t)},!0),i.$watch("config.credits.enabled",function(t){t?g.credits.show():g.credits&&g.credits.hide()}),i.$watch(f,function(t,n){t!==n&&l()}),angular.forEach(r,function(t){i.$watch("config."+t,function(n,i){if(n!==i&&n){if(angular.isArray(n))for(var e=0;e<n.length;e++){var r=n[e];e<g[t].length&&(g[t][e].update(r,!1),c(g[t][e],angular.copy(r)))}else g[t][0].update(n,!1),c(g[t][0],angular.copy(n));g.redraw()}},!0)}),i.$watch("config.options",function(t,n,i){t!==n&&(l(),d(i.config.series),g.redraw())},!0),i.$watch("config.size",function(t,n){t!==n&&t&&g.setSize(t.width||g.chartWidth,t.height||g.chartHeight)},!0),i.$on("highchartsng.reflow",function(){g.reflow()}),i.$on("$destroy",function(){if(g){try{g.destroy()}catch(t){}n(function(){a.remove()},0)}})}}}angular.module("highcharts-ng",[]).factory("highchartsNGUtils",t).directive("highchart",["highchartsNGUtils","$timeout",n])}();